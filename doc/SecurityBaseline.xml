<?xml version="1.0"?>
<?xml-stylesheet href="docbook.xsl" type="text/xsl" ?>
<book xmlns="http://docbook.org/ns/docbook" version="5.0">
  <info>
    <title>Security Baseline Specification</title>
    <titleabbrev>SecurityBaseline</titleabbrev>
    <releaseinfo>25.12 Draft</releaseinfo>
    <author>
      <orgname>ONVIF™</orgname>
      <uri>www.onvif.org</uri>
    </author>
    <pubdate>March 2025</pubdate>
    <mediaobject>
      <imageobject>
        <imagedata fileref="media/logo.png" contentwidth="60mm"/>
      </imageobject>
    </mediaobject>
    <copyright>
      <year>2008-2025</year>
      <holder>ONVIF™ All rights reserved.</holder>
    </copyright>
    <legalnotice>
      <para>Recipients of this document may copy, distribute, publish, or display this document so
        long as this copyright notice, license and disclaimer are retained with all copies of the
        document. No license is granted to modify this document.</para>
      <para>THIS DOCUMENT IS PROVIDED "AS IS," AND THE CORPORATION AND ITS MEMBERS AND THEIR
        AFFILIATES, MAKE NO REPRESENTATIONS OR WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT
        LIMITED TO, WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE,
        NON-INFRINGEMENT, OR TITLE; THAT THE CONTENTS OF THIS DOCUMENT ARE SUITABLE FOR ANY PURPOSE;
        OR THAT THE IMPLEMENTATION OF SUCH CONTENTS WILL NOT INFRINGE ANY PATENTS, COPYRIGHTS,
        TRADEMARKS OR OTHER RIGHTS.</para>
      <para>IN NO EVENT WILL THE CORPORATION OR ITS MEMBERS OR THEIR AFFILIATES BE LIABLE FOR ANY
        DIRECT, INDIRECT, SPECIAL, INCIDENTAL, PUNITIVE OR CONSEQUENTIAL DAMAGES, ARISING OUT OF OR
        RELATING TO ANY USE OR DISTRIBUTION OF THIS DOCUMENT, WHETHER OR NOT (1) THE CORPORATION,
        MEMBERS OR THEIR AFFILIATES HAVE BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES, OR (2)
        SUCH DAMAGES WERE REASONABLY FORESEEABLE, AND ARISING OUT OF OR RELATING TO ANY USE OR
        DISTRIBUTION OF THIS DOCUMENT.  THE FOREGOING DISCLAIMER AND LIMITATION ON LIABILITY DO NOT
        APPLY TO, INVALIDATE, OR LIMIT REPRESENTATIONS AND WARRANTIES MADE BY THE MEMBERS AND THEIR
        RESPECTIVE AFFILIATES TO THE CORPORATION AND OTHER MEMBERS IN CERTAIN WRITTEN POLICIES OF
        THE CORPORATION.</para>
    </legalnotice>
    <revhistory>
      <revision>
        <revnumber>25.12</revnumber>
        <date>Dec-2025</date>
        <author>
          <personname>Hans Busch</personname>
        </author>
        <revremark>Draft</revremark>
      </revision>
    </revhistory>
  </info>
  <chapter>
    <title>Scope</title>
    <para>This document defines the security baseline for ONVIF specifications. Its content is based on state of the art technology as published by NIST or BSI. </para>
    <para>Note, that any updates to this specification require a review of implications on technical, profile and addon specifications. 
      Publication of updates must synchronized with ONVIF Technical and Technical Service Committee</para>
  </chapter>
  <chapter>
    <title>Normative References</title>
    <para>NIST FIPS 180-4 Secure Hash Standard (SHS)</para>
    <para>&lt;<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf"/>&gt; </para>
    <para>NIST FIPS 186-5 Digital Signature Standard (DSS) - February 3, 2023</para>
    <para>&lt;<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-5.pdf"/>&gt;</para>
    <para>BSI – Technical Guideline, Cryptographic Mechanisms: Recommendations and Key Length- January 31, 2025</para>
    <para>&lt;<link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/TechGuidelines/TG02102/BSI-TR-02102-1.pdf?__blob=publicationFile&amp;v=9"/>&gt;</para>
  </chapter>
  <chapter>
    <title>Definitions</title>
    <informaltable>
      <tgroup cols="2">
        <colspec colname="c1" colwidth="27*" />
        <colspec colname="c2" colwidth="73*" />
        <tbody valign="top">
          <row>
            <entry>
              <para>Provisioning</para>
            </entry>
            <entry>
              <para>Doing something in advance to prepare for something else.</para>
            </entry>
          </row>
          <row>
            <entry>
              <para>Video Source</para>
            </entry>
            <entry>
              <para>Entity defined by [ONVIF Device I/O Specification]</para>
            </entry>
          </row>
          <row>
            <entry>
              <para>Video Source Token</para>
            </entry>
            <entry>
              <para>Token referencing a Device I/O Video Source</para>
            </entry>
          </row>
        </tbody>
      </tgroup>
    </informaltable>
  </chapter>
  <chapter>
    <title>Overview</title>
    <para>All sections in this specification are normative unless explicitly marked as informative.</para>
  </chapter>
  <chapter>
    <title>Asymmetric Encryption Schemes and Key Agreement</title>
    <para>ONVIF recommends to support the following mechanism</para>
    <table xml:id="_Ref395173040">
      <title>Assymmetric Key Schemes</title>
      <tgroup cols="3">
        <colspec colname="c1" colwidth="52*"/>
        <colspec colname="c2" colwidth="12*"/>
        <colspec colname="c3" colwidth="12*"/>
        <thead>
          <row>
            <entry>
              <para>Name</para>
            </entry>
            <entry>
              <para>Key Length </para>
            </entry>
            <entry>
              <para>Comment</para>
            </entry>
          </row>
        </thead>
        <tbody valign="top">
          <row>
            <entry>
              <para>RSA</para>
            </entry>
            <entry>
              <para>>3000 Bit</para>
            </entry>
            <entry>RFC xxxx</entry>
          </row>
          <row>
            <entry>sha256WithRSAEncrpytion</entry>
            <entry>4096</entry>
            <entry>RSA Baseline</entry>
          </row>
          <row>
            <entry>EC Diffie-Hellman</entry>
            <entry>>250 Bit</entry>
            <entry></entry>
          </row>
          <row>
            <entry>secp256r1</entry>
            <entry>256</entry>
            <entry>EC Baseline</entry>
          </row>
        </tbody>
      </tgroup>
    </table>
  </chapter>
  <chapter>
    <title>Symmetric Encryption Schemes</title>
    <para></para>
    <table xml:id="symTable">
      <title>Symmetric Encryption Schemes</title>
      <tgroup cols="3">
        <colspec colname="c1" colwidth="52*"/>
        <colspec colname="c2" colwidth="12*"/>
        <colspec colname="c3" colwidth="12*"/>
        <thead>
          <row>
            <entry>
              <para>Name</para>
            </entry>
            <entry>
              <para>Key Length </para>
            </entry>
            <entry>
              <para>Comment</para>
            </entry>
          </row>
        </thead>
        <tbody valign="top">
          <row>
            <entry>
              <para>AES</para>
            </entry>
            <entry>
              <para>>= 192 Bit</para>
            </entry>
            <entry></entry>
          </row>
          <row>
            <entry>AES-256</entry>
            <entry>256</entry>
            <entry>Baseline</entry>
          </row>
          <row>
            <entry>AES-GCM</entry>
            <entry>>= 192 Bit</entry>
            <entry/>
          </row>
          <row>
            <entry>AES-AEAD</entry>
            <entry>>= 256 Bit</entry>
            <entry>RFC 7539</entry>
          </row>
          <row>
            <entry>CHACHA20_POLY1305</entry>
            <entry>>= 256 Bit</entry>
            <entry>RFC 8439</entry>
          </row>
        </tbody>
      </tgroup>
    </table>
  </chapter>
  <chapter>
    <title>Hash Functions and Signatures</title>
    <para></para>
    <table xml:id="sigTable">
      <title>Hashes and Signatures</title>
      <tgroup cols="3">
        <colspec colname="c1" colwidth="52*"/>
        <colspec colname="c2" colwidth="12*"/>
        <colspec colname="c3" colwidth="12*"/>
        <thead>
          <row>
            <entry>
              <para>Name</para>
            </entry>
            <entry>
              <para>Key Length </para>
            </entry>
            <entry>
              <para>Reference</para>
            </entry>
          </row>
        </thead>
        <tbody valign="top">
          <row>
            <entry>
              <para>SHA-2</para>
            </entry>
            <entry>
              <para>>= 384 Bit</para>
            </entry>
            <entry/>
          </row>
          <row>
            <entry>sha256WithRSAEncryption</entry>
            <entry>256 Bit</entry>
            <entry>RFC 4055</entry>
          </row>
          <row>
            <entry>SHA-3</entry>
            <entry>>= 256 Bit</entry>
            <entry/>
          </row>
          <row>
            <entry>RSASSA-PSS</entry>
            <entry>>= 3000</entry>
            <entry/>
          </row>
          <row>
            <entry>ECDSA</entry>
            <entry>>= 256 Bit</entry>
            <entry/>
          </row>
        </tbody>
      </tgroup>
    </table>
  </chapter>
  <chapter>
    <title>Key Derivation</title>
    <table xml:id="sigTable2">
      <title>Key Derivation Functions</title>
      <tgroup cols="3">
        <colspec colname="c1" colwidth="52*"/>
        <colspec colname="c2" colwidth="12*"/>
        <colspec colname="c3" colwidth="12*"/>
        <thead>
          <row>
            <entry>
              <para>Name</para>
            </entry>
            <entry>
              <para>Key Length </para>
            </entry>
            <entry>
              <para>Reference</para>
            </entry>
          </row>
        </thead>
        <tbody valign="top">
          <row>
            <entry>
              <para>pbeWithSHAAnd3-KeyTripleDES-CBC replace !!!!</para>
            </entry>
            <entry>
              <para/>
            </entry>
            <entry/>
          </row>
        </tbody>
      </tgroup>
    </table>
    <para>As common baseline devices and clients shall support sha256WithRSAEncryption or
      sha256</para>
  </chapter>
  <appendix xml:id= "b14_55m_51d">
    <title>Cipher Reference (Informative)</title>
    
    <para>This Annex is advocating a small subset of Ciphers as part of the ONVIF standard that readers of this specification can use as an informative guide. The following small subset of ciphers covering TLS 1.2 / 1.3 are common recommendations issued as guidance by the bodies Cloudflare, IETF (TLS 1.2, TLS1.3), Mozilla, and ciphersuite.info (TLS 1.2, TLS 1.3).</para>
    
    <para>While TLS 1.2 and 1.3 are both currently viable, we would suggest that TLS 1.3 is preferred. Do note that the table is not ordered by the strength of the cipher.</para>
    
    <table>
      <title>TLS 1.3 / 1.2 Cipher list</title>
      <tgroup cols="2">
        <colspec colname="c1" colwidth="50*"/>
        <colspec colname="c2" colwidth="50*"/>
        <thead>
          <row>
            <entry><para>Minimum Protocol</para></entry><entry><para>IANA Name</para></entry>
          </row>
        </thead>
        
        <tbody valign="top">
          <row>
            <entry><para>TLS 1.3</para></entry><entry><para>TLS_AES_256_GCM_SHA384</para></entry>
          </row>
          <row>
            <entry><para>TLS 1.3</para></entry><entry><para>TLS_CHACHA20_POLY1305_SHA256</para></entry>
          </row>
          <row>
            <entry><para>TLS 1.2</para></entry><entry><para>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</para></entry>
          </row>
          <row>
            <entry><para>TLS 1.2</para></entry><entry><para>TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256</para></entry>
          </row>
          <row>
            <entry><para>TLS 1.2</para></entry><entry><para>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</para></entry>
          </row>
          <row>
            <entry><para>TLS 1.2</para></entry><entry><para>TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</para></entry>
          </row>
          <row>
            <entry><para>TLS 1.2</para></entry><entry><para>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384</para></entry>
          </row>
          <row>
            <entry><para>TLS 1.2</para></entry><entry><para>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384</para></entry>
          </row>
        </tbody>
      </tgroup>
    </table>
  </appendix>
  <appendix role="revhistory">
    <title>Revision History</title>
    <para />
  </appendix>
</book>
